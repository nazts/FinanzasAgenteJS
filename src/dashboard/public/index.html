<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FinanzasBot â€” Analytics Dashboard</title>
  <meta name="description"
    content="Panel de analÃ­ticas SaaS para monitorear interacciones, usuarios y finanzas del bot FinanzasBot" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>

  <!-- â”€â”€ Login Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="loginOverlay" class="login-overlay">
    <div class="login-card">
      <div class="login-logo">ğŸ”</div>
      <h2>FinanzasBot Admin</h2>
      <p>Ingresa la clave de administrador</p>
      <form id="loginForm">
        <input type="password" id="adminKeyInput" placeholder="Admin Key" autocomplete="off" required />
        <button type="submit" id="loginBtn">Acceder</button>
        <p id="loginError" class="login-error"></p>
      </form>
    </div>
  </div>

  <!-- â”€â”€ Main App (hidden until auth) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="appContainer" class="app-container hidden">

    <!-- â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <span class="logo-icon">ğŸ’°</span>
          <h1>FinanzasBot <span class="badge">Analytics</span></h1>
        </div>
        <p class="subtitle">SaaS Analytics Dashboard â€” Monitoreo de producto</p>
      </div>
      <div class="header-right">
        <div class="status-indicator">
          <span class="pulse"></span>
          <span>En vivo</span>
        </div>
        <span id="lastUpdated" class="last-updated"></span>
        <button id="logoutBtn" class="logout-btn" title="Cerrar sesiÃ³n">ğŸšª</button>
      </div>
    </header>

    <!-- â”€â”€ Nav Tabs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <nav class="nav-tabs" id="navTabs">
      <button class="nav-tab active" data-tab="overview">ğŸ“Š Overview</button>
      <button class="nav-tab" data-tab="users">ğŸ‘¥ Usuarios</button>
      <button class="nav-tab" data-tab="interactions">ğŸ¤– Interacciones</button>
      <button class="nav-tab" data-tab="finance">ğŸ’° Finanzas</button>
      <button class="nav-tab" data-tab="funnel">ğŸ”„ Embudo</button>
      <button class="nav-tab" data-tab="behavioral">ğŸ§  Behavioral</button>
    </nav>

    <!-- â•â•â• TAB: Overview â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section id="tab-overview" class="tab-content active">

      <!-- KPI Cards -->
      <div class="kpi-grid kpi-grid-8">
        <div class="kpi-card kpi-c1">
          <div class="kpi-icon">ğŸ‘¥</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-totalUsers">â€”</span><span
              class="kpi-label">Registrados</span></div>
        </div>
        <div class="kpi-card kpi-c2">
          <div class="kpi-icon">âš¡</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-active7d">â€”</span><span class="kpi-label">Activos
              7d</span></div>
        </div>
        <div class="kpi-card kpi-c3">
          <div class="kpi-icon">ğŸ“†</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-active30d">â€”</span><span class="kpi-label">Activos
              30d</span></div>
        </div>
        <div class="kpi-card kpi-c4">
          <div class="kpi-icon">âœ…</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-onboardedUsers">â€”</span><span
              class="kpi-label">Onboarded</span></div>
        </div>
        <div class="kpi-card kpi-c5">
          <div class="kpi-icon">ğŸ¤–</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-totalCommands">â€”</span><span
              class="kpi-label">Comandos</span></div>
        </div>
        <div class="kpi-card kpi-c6">
          <div class="kpi-icon">ğŸ“Š</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-totalTransactions">â€”</span><span
              class="kpi-label">Transacciones</span></div>
        </div>
        <div class="kpi-card kpi-c7">
          <div class="kpi-icon">ğŸ“ˆ</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-totalIncome">â€”</span><span
              class="kpi-label">Ingresos</span></div>
        </div>
        <div class="kpi-card kpi-c8">
          <div class="kpi-icon">ğŸ“‰</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-totalExpenses">â€”</span><span
              class="kpi-label">Gastos</span></div>
        </div>
      </div>

      <!-- Charts row -->
      <div class="charts-row">
        <div class="chart-card chart-wide">
          <h2 class="chart-title">ğŸ“… Crecimiento de Usuarios (30 dÃ­as)</h2>
          <div class="chart-container"><canvas id="chartUserGrowth"></canvas></div>
        </div>
        <div class="chart-card">
          <h2 class="chart-title">ğŸ¤– Uso por Comando</h2>
          <div class="chart-container"><canvas id="chartCommandDist"></canvas></div>
        </div>
      </div>
    </section>

    <!-- â•â•â• TAB: Users â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section id="tab-users" class="tab-content">
      <div class="section-full">
        <div class="chart-card">
          <h2 class="chart-title">ğŸ‘¥ Todos los Usuarios â€” Ordenados por Actividad</h2>
          <div class="table-wrapper">
            <table class="data-table" id="usersTable">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Telegram ID</th>
                  <th>Comandos</th>
                  <th>Transacciones</th>
                  <th>Ingresos</th>
                  <th>Gastos</th>
                  <th>Salario</th>
                  <th>Onboarding</th>
                  <th>Ãšltima Actividad</th>
                </tr>
              </thead>
              <tbody id="usersTableBody">
                <tr>
                  <td colspan="9" class="no-data">Cargando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- â•â•â• TAB: Interactions â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section id="tab-interactions" class="tab-content">

      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card kpi-c5">
          <div class="kpi-icon">ğŸ¤–</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-intTotalCmds">â€”</span><span class="kpi-label">Total
              Comandos</span></div>
        </div>
        <div class="kpi-card kpi-c2">
          <div class="kpi-icon">â­</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-intMostUsed">â€”</span><span class="kpi-label">MÃ¡s
              Usado</span></div>
        </div>
        <div class="kpi-card kpi-c3">
          <div class="kpi-icon">ğŸ“Š</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-intAvgPerUser">â€”</span><span
              class="kpi-label">Promedio/Usuario</span></div>
        </div>
        <div class="kpi-card kpi-c4">
          <div class="kpi-icon">ğŸ‘¥</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-intTop10Count">â€”</span><span
              class="kpi-label">Usuarios Activos</span></div>
        </div>
      </div>

      <div class="charts-row">
        <div class="chart-card chart-wide">
          <h2 class="chart-title">ğŸ“ˆ Comandos por DÃ­a (30 dÃ­as)</h2>
          <div class="chart-container"><canvas id="chartCmdsPerDay"></canvas></div>
        </div>
        <div class="chart-card">
          <h2 class="chart-title">ğŸ“Š DistribuciÃ³n de Comandos</h2>
          <div class="chart-container chart-container-donut"><canvas id="chartCmdDonut"></canvas></div>
        </div>
      </div>

      <div class="charts-row charts-row-equal">
        <div class="chart-card">
          <h2 class="chart-title">ğŸ† Top 10 Usuarios por Comandos</h2>
          <div class="table-wrapper">
            <table class="data-table" id="intTop10Table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Usuario</th>
                  <th>Comandos</th>
                </tr>
              </thead>
              <tbody id="intTop10Body">
                <tr>
                  <td colspan="3" class="no-data">Cargando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="chart-card">
          <h2 class="chart-title">ğŸ•‘ Actividad Reciente (Comandos)</h2>
          <div class="table-wrapper table-scroll">
            <table class="data-table" id="intRecentTable">
              <thead>
                <tr>
                  <th>Hora</th>
                  <th>Usuario</th>
                  <th>Comando</th>
                </tr>
              </thead>
              <tbody id="intRecentBody">
                <tr>
                  <td colspan="3" class="no-data">Cargando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- â•â•â• TAB: Finance â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section id="tab-finance" class="tab-content">

      <div class="kpi-grid kpi-grid-6">
        <div class="kpi-card kpi-c7">
          <div class="kpi-icon">ğŸ’µ</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-finAvgSalary">â€”</span><span class="kpi-label">Salario
              Promedio</span></div>
        </div>
        <div class="kpi-card kpi-c2">
          <div class="kpi-icon">ğŸ’</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-finAvgSavings">â€”</span><span class="kpi-label">Ahorro
              Promedio %</span></div>
        </div>
        <div class="kpi-card kpi-c3">
          <div class="kpi-icon">ğŸ“</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-finDeviation">â€”</span><span
              class="kpi-label">DesviaciÃ³n 50/30/20</span></div>
        </div>
        <div class="kpi-card kpi-c8">
          <div class="kpi-icon">âš ï¸</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-finLowSavers">â€”</span><span class="kpi-label">% Ahorro
              <10%< /span>
          </div>
        </div>
        <div class="kpi-card kpi-c1">
          <div class="kpi-icon">ğŸ </div>
          <div class="kpi-content"><span class="kpi-value" id="kv-finAvgLeisure">â€”</span><span class="kpi-label">Gasto
              Ocio Prom.</span></div>
        </div>
        <div class="kpi-card kpi-c6">
          <div class="kpi-icon">ğŸš¨</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-finOverIndebted">â€”</span><span class="kpi-label">%
              Sobreendeudados</span></div>
        </div>
      </div>

      <div class="charts-row">
        <div class="chart-card chart-wide">
          <h2 class="chart-title">ğŸ“ˆ EvoluciÃ³n Mensual â€” Ingresos vs Gastos (6 meses)</h2>
          <div class="chart-container"><canvas id="chartEvolution"></canvas></div>
        </div>
        <div class="chart-card">
          <h2 class="chart-title">ğŸ¯ DistribuciÃ³n Real 50/30/20</h2>
          <div class="chart-container chart-container-donut"><canvas id="chartCategoryDonut"></canvas></div>
        </div>
      </div>

      <div class="charts-row charts-row-equal">
        <div class="chart-card">
          <h2 class="chart-title">âš ï¸ Usuarios con Ahorro Bajo (&lt;10%)</h2>
          <div class="table-wrapper">
            <table class="data-table" id="lowSaversTable">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Salario</th>
                  <th>Ahorro %</th>
                </tr>
              </thead>
              <tbody id="lowSaversBody">
                <tr>
                  <td colspan="3" class="no-data">Cargando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="chart-card">
          <h2 class="chart-title">ğŸš¨ Usuarios Sobreendeudados (&gt;40%)</h2>
          <div class="table-wrapper">
            <table class="data-table" id="indebtedTable">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Salario</th>
                  <th>Deuda/Mes</th>
                  <th>% Deuda</th>
                </tr>
              </thead>
              <tbody id="indebtedBody">
                <tr>
                  <td colspan="4" class="no-data">Cargando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- â•â•â• TAB: Funnel â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section id="tab-funnel" class="tab-content">

      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card kpi-c2">
          <div class="kpi-icon">ğŸ”</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-retention7d">â€”</span><span class="kpi-label">RetenciÃ³n
              7d</span></div>
        </div>
        <div class="kpi-card kpi-c3">
          <div class="kpi-icon">ğŸ“Š</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-retentionRate">â€”</span><span class="kpi-label">Tasa
              RetenciÃ³n</span></div>
        </div>
        <div class="kpi-card kpi-c8">
          <div class="kpi-icon">ğŸšª</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-abandonedOB">â€”</span><span
              class="kpi-label">Abandonaron OB</span></div>
        </div>
        <div class="kpi-card kpi-c5">
          <div class="kpi-icon">ğŸ“‹</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-startedOB">â€”</span><span class="kpi-label">Iniciaron
              OB</span></div>
        </div>
      </div>

      <div class="section-full">
        <div class="chart-card">
          <h2 class="chart-title">ğŸ”„ Embudo de ConversiÃ³n</h2>
          <div id="funnelContainer" class="funnel-container">
            <p class="no-data">Cargando embudo...</p>
          </div>
        </div>
      </div>

      <div class="section-full">
        <div class="chart-card">
          <h2 class="chart-title">ğŸ“Š Embudo Visual</h2>
          <div class="chart-container" style="height:320px"><canvas id="chartFunnel"></canvas></div>
        </div>
      </div>
    </section>

    <!-- â•â•â• TAB: Behavioral â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section id="tab-behavioral" class="tab-content">

      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card kpi-c5">
          <div class="kpi-icon">âš¡</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-behSpikes">â€”</span><span class="kpi-label">Usuarios con Picos</span></div>
        </div>
        <div class="kpi-card kpi-c8">
          <div class="kpi-icon">ğŸŒŠ</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-behDrift">â€”</span><span class="kpi-label">Drift Promedio</span></div>
        </div>
        <div class="kpi-card kpi-c3">
          <div class="kpi-icon">ğŸ“Š</div>
          <div class="kpi-content"><span class="kpi-value" id="kv-behDrifting">â€”</span><span class="kpi-label">% Drifting</span></div>
        </div>
        <div class="kpi-card kpi-c2">
          <div class="kpi-icon">ğŸ§ </div>
          <div class="kpi-content"><span class="kpi-value" id="kv-behAnalyzed">â€”</span><span class="kpi-label">Analizados</span></div>
        </div>
      </div>

      <div class="charts-row">
        <div class="chart-card chart-wide">
          <h2 class="chart-title">ğŸ’° Tendencia Global de Ahorro (6 meses)</h2>
          <div class="chart-container"><canvas id="chartSavingsTrend"></canvas></div>
        </div>
        <div class="chart-card">
          <h2 class="chart-title">ğŸ“Š Incremento Promedio por CategorÃ­a</h2>
          <div class="chart-container"><canvas id="chartCategoryGrowth"></canvas></div>
        </div>
      </div>

      <div class="charts-row charts-row-equal">
        <div class="chart-card">
          <h2 class="chart-title">ğŸ¯ DistribuciÃ³n de Riesgo Conductual</h2>
          <div class="chart-container chart-container-donut"><canvas id="chartRiskDist"></canvas></div>
        </div>
        <div class="chart-card">
          <h2 class="chart-title">âš¡ Usuarios con Picos Recurrentes</h2>
          <div class="table-wrapper">
            <table class="data-table" id="spikesTable">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Riesgo</th>
                  <th>Picos</th>
                  <th>CategorÃ­as</th>
                </tr>
              </thead>
              <tbody id="spikesBody">
                <tr>
                  <td colspan="4" class="no-data">Cargando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <p>FinanzasBot Analytics Dashboard &copy; 2026 â€” Datos en tiempo real &middot; Auto-refresh cada 30s</p>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
  <script src="app.js"></script>
</body>

</html>